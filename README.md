# Лабораторная Работа 5 по C#
**Горбунов Глеб, ИТ-11-2024**

**Вариант №3**

Разработать консольное приложение с дружественным интерфейсом с возможностью выбора заданий. Приложение должно выполнять следующие функции:
1. Чтение базы данных из CSV файлов
2. Просмотр базы данных
3. Удаление элементов (по ключу)
4. Добавление элементов
5. Реализация 4 запросов:
   - 5.1. вывести экспонаты определенной эпохи
   - 5.2. найти выручку по эпохе и месяцу
   - 5.3. найти всех посетителей по эпохе
   - 5.4. найти количество уникальных посетителей по эпохе
6. Сохранение изменений в CSV файлах

Весь функционал приложения реализован в виде методов вспомогательного класса с помощью LINQ-запросов. Предусмотрена обработка возможных ошибок при работе программы.

### Классы

**Exhibit (Экспонат):**
- ID - идентификатор экспоната
- Name - название экспоната
- Era - эпоха экспоната

**Visitor (Посетитель):**
- ID - идентификатор посетителя
- Name - имя посетителя
- Age - возраст посетителя
- Gender - пол посетителя

**Ticket (Билет):**
- ID - идентификатор билета
- ExhibitID - ссылка на экспонат
- VisitorID - ссылка на посетителя
- Date - дата посещения
- Cost - стоимость билета

### класс Museum

Класс `Museum` служит центральным компонентом приложения и содержит:
- Коллекции для хранения экспонатов, посетителей и билетов
- Методы для загрузки и сохранения данных в CSV файлы
- Методы для операций (создание, чтение, обновление, удаление)
- LINQ-запросы для выполнения задач

**Алгоритм работы:**

1. **Инициализация:** При создании объекта Museum инициализируются пустые списки для экспонатов, посетителей и билетов.

2. **Загрузка данных:** Метод `LoadData()` читает данные из трех CSV файлов, пропуская заголовки и создавая соответствующие объекты.

3. **Сохранение данных:** Метод `SaveData()` записывает текущее состояние коллекций обратно в CSV файлы с заголовками.

4. **Просмотр данных:** Метод `ViewAllData()` выводит все записи из трех коллекций в форматированном виде.

5. **Добавление элементов:** Методы `AddExhibit()`, `AddVisitor()`, `AddTicket()` добавляют новые объекты в соответствующие коллекции.

6. **Удаление элементов:** Методы `DeleteExhibit()`, `DeleteVisitor()`, `DeleteTicket()` находят объекты по ID и удаляют их из коллекций.

7. **LINQ-запросы:**
   - `ExhibitsEra()` - фильтрует экспонаты по указанной эпохе
   - `Revenue()` - вычисляет суммарную выручку по эпохе за указанный месяц и год
   - `VisitorsEra()` - находит имена всех посетителей, которые посещали экспонаты указанной эпохи
   - `VisitorsCountEra()` - подсчитывает количество уникальных посетителей по эпохе

`Program` реализует консольное меню с основными функциями:

1. **Главное меню:** Предлагает 6 основных опций управления музеем
2. **Обработка выбора:** Использует switch-case для навигации по функциям
3. **Обработка ошибок:** Try-catch блоки для обработки исключений ввода

## Тестирование

### 1. Просмотр базы данных

```
=== экспонаты ===
ID: 1, Название: Шлем рыцаря, Эпоха: Средневековье
ID: 2, Название: Портрет дамы, Эпоха: Ренессанс
ID: 3, Название: Статуя ангела, Эпоха: Экспрессионизм
...
ID: 45, Название: Греческий шлем, Эпоха: Античность

=== посетители ===
ID: 1, Имя: Анна Иванова, Возраст: 25, Пол: Ж
ID: 2, Имя: Петр Сидоров, Возраст: 34, Пол: М
...
ID: 25, Имя: Валентина Титова, Возраст: 48, Пол: Ж

=== билеты ===
ID: 1, ID экспоната: 5, ID посетителя: 3, Дата: 15.03.2024, Стоимость: 12.50
ID: 2, ID экспоната: 12, ID посетителя: 8, Дата: 15.03.2024, Стоимость: 15.00
...
ID: 45, ID экспоната: 23, ID посетителя: 21, Дата: 06.04.2024, Стоимость: 16.00
```

### 2. Удаление элементов

```
=== удаление элементов ===
1. удалить экспонат
2. удалить посетителя
3. удалить билет
выбери действие: 2
введи id для удаления: 1
удаление успешно

=== посетители ===
ID: 2, Имя: Петр Сидоров, Возраст: 34, Пол: М
ID: 3, Имя: Мария Козлова, Возраст: 29, Пол: Ж
...
ID: 25, Имя: Валентина Титова, Возраст: 48, Пол: Ж
```

### 3. Добавление элементов

```
=== добавление элементов ===
1. добавить экспонат
2. добавить посетителя
3. добавить билет
выбери действие: 2
ID: 1
имя: Корнелиус
возраст: 34
пол: М
добавление успешно

=== посетители ===
ID: 2, Имя: Петр Сидоров, Возраст: 34, Пол: М
...
ID: 25, Имя: Валентина Титова, Возраст: 48, Пол: Ж
ID: 1, Имя: Корнелиус, Возраст: 34, Пол: М
```

### 4. Выполнение запросов

#### 4.1. Экспонаты определенной эпохи
```
выбери запрос: 1
введи эпоху: Поп-арт

результат:
ID: 15, Название: Кованые ворота, Эпоха: Поп-арт
ID: 19, Название: Кольцо с рубином, Эпоха: Поп-арт
ID: 21, Название: Античная ваза, Эпоха: Поп-арт
ID: 25, Название: Бронзовый бюст, Эпоха: Поп-арт
ID: 44, Название: Средневековый кинжал, Эпоха: Поп-арт
```

#### 4.2. Выручка по эпохе и месяцу
```
выбери запрос: 2
введи эпоху: Поп-арт
введи год: 2024
введи месяц: 03

выручка: 31.50
```

#### 4.3. Все посетители по эпохе
```
выбери запрос: 3
введи эпоху: Поп-арт

посетители:
Дмитрий Волков
Владимир Соколов
Мария Козлова
Алексей Петров
```

#### 4.4. Количество уникальных посетителей по эпохе
```
выбери запрос: 4
введи эпоху: Поп-арт

количество уникальных посетителей: 4
```
